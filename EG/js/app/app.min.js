var app=angular.module("EGApp",["ngRoute","ngMaterial","ngMessages","ngCookies","base64"]);app.config(function(e,a){a.theme("docs-dark","default").primaryPalette("yellow").dark(),e.when("/",{controller:"mainCtrl",templateUrl:"views/home.html"}).when("/categories",{controller:"mainCtrl",templateUrl:"views/categories.html"}).when("/event",{controller:"mainCtrl",templateUrl:"views/book.html"}).when("/final",{controller:"mainCtrl",templateUrl:"views/final.html"}).when("/privacy",{controller:"mainCtrl",templateUrl:"views/privacy.html"}).when("/verify",{controller:"mainCtrl",templateUrl:"views/verify.html"}).when("/mybooking",{controller:"mainCtrl",templateUrl:"views/mybooking.html"}).when("/myqueries",{controller:"mainCtrl",templateUrl:"views/myqueries.html"}).when("/paynow",{controller:"mainCtrl",templateUrl:"views/paynow.html"}).when("/thankyou",{controller:"mainCtrl",templateUrl:"views/thankyou.html"}).otherwise({redirectTo:"/"})}),app.controller("mainCtrl",["$scope","$http","$location","$mdDialog","$mdMedia","$timeout","$cookies","$base64",function(e,a,n,s,t,o,r,i){function l(e,s){e.hide=function(){s.hide()},e.cancel=function(){s.cancel()},e.answer=function(e){s.hide(e)},e.displayPromo=function(){$(".promoBTN").hide(),$(".promoCodeOption").fadeIn()},e.tryPromoCode=function(){var n={headers:{"Content-Type":"application/x-www-form-urlencoded;"}};data="appId=2&offerCode=:xuserPromoCodex:ffer&amount=:xtotalAmountx:",data=data.replace(":xuserPromoCodex:",e.userPromoCode),data=data.replace(":xtotalAmountx:",e.totalAmount);var s=a.post("http://dhiya.16mb.com/eg-api/customer/applyOffer",data,n);s.success(function(e,a,n,s){console.log(e)}),s.error(function(e,a,n,s){})},e.userMessage="",e.userRegister=function(){var s={headers:{"Content-Type":"application/x-www-form-urlencoded;"}};data="name=:xuserfnamex:&contact=:xusercontactx:&email=:xuseremailx:&password=:xuserpasswordx:&appId=2",data=data.replace(":xuserfnamex:",e.userFname),data=data.replace(":xuseremailx:",e.useremail),data=data.replace(":xusercontactx:",e.usermobile),data=data.replace(":xuserpasswordx:",e.userpassword);var t=a.post("http://dhiya.16mb.com/eg-api/registerCustomer",data,s);t.success(function(a,s,t,r){console.log(a),("Already Registered!"==a.message&&"pending"==a.verification||(a.message="registered Mail Sent"))&&(e.userMessage=a.message,o(function(){e.cancel(),n.path("/verify")},3e3)),"Already Registered!"==a.message&&"done"==a.verification&&(e.userMessage="Already Registered, Please Login")}),t.error(function(a,n,s,t){e.userMessage="Something went wrong please try again later"})},e.userLogin=function(){var s={headers:{"Content-Type":"application/x-www-form-urlencoded;"}};data="email=:xusernamex:&password=:xuserpasswordx:&appId=2",data=data.replace(":xusernamex:",e.username),data=data.replace(":xuserpasswordx:",e.userpassword);var t=a.post("http://dhiya.16mb.com/eg-api/loginCustomer",data,s);t.success(function(a,s,t,i){e.userNamex=a.data[0].name,r.put("loginuser",e.userNamex,""),"Login Success"==a.usermessage&&"pending"==a.data[0].verification?("Please Verify your account"==e.userMessage,n.path("/verify"),$(".nav-wrapper").html('<div id="nav-icon"> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> </div> <a href="#/" class="brand-logo center"><img src="./media/images/logo.png" style="width: 90px; margin: 5px;"></a> <ul class="right usermenuul"> <li><a class="usermenu"> '+e.userNamex+' &nbsp; &nbsp; <i class="fa fa-chevron-circle-down"></i> </a> <ul> <div class="usermenudiv"> <div class="usermenupic"><span>'+e.userNamex+'</span> <img src="https://image.freepik.com/free-icon/male-user-shadow_318-34042.png"> </div> <div class="usermenuopt"><a href="#/mybooking">My Booking</a></div> <div class="usermenuopt"><a href="#/profile">Profile</a></div> <div class="usermenuopt"><a onclick="logOut()" href="#/">LogOut</a></div> </div> </ul> </li> </ul> <script> $("#nav-icon").click(function(){ $(this).toggleClass("open"); $(".leftSubMenu").toggleClass("leftsubmenupos"); $(".leftoverlay").toggleClass("leftmenubackdrop"); $("nav").toggleClass("navbarline"); }); $(".usermenu, .usermenudiv").mouseenter(function() { $(".usermenudiv").show(); $(".usermenu").addClass("usermenuwhite"); }); $(".usermenu, .usermenudiv").mouseleave(function() { $(".usermenudiv").hide(); $(".usermenu").removeClass("usermenuwhite"); });</script>'),r.put("loginStatus","true","")):"Login Success"==a.message?(r.put("loginStatus","true",""),e.userMessage=a.message,$(".nav-wrapper").html('<div id="nav-icon"> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> </div> <a href="#/" class="brand-logo center"><img src="./media/images/logo.png" style="width: 90px; margin: 5px;"></a> <ul class="right usermenuul"> <li><a class="usermenu"> '+e.userNamex+' &nbsp; &nbsp; <i class="fa fa-chevron-circle-down"></i> </a> <ul> <div class="usermenudiv"> <div class="usermenupic"><span>'+e.userNamex+'</span> <img src="https://image.freepik.com/free-icon/male-user-shadow_318-34042.png"> </div> <div class="usermenuopt"><a href="#/mybooking">My Booking</a></div> <div class="usermenuopt"><a href="#/profile">Profile</a></div> <div class="usermenuopt"><a onclick="logOut()" href="#/">LogOut</a></div> </div> </ul> </li> </ul> <script> $("#nav-icon").click(function(){ $(this).toggleClass("open"); $(".leftSubMenu").toggleClass("leftsubmenupos"); $(".leftoverlay").toggleClass("leftmenubackdrop"); $("nav").toggleClass("navbarline"); }); $(".usermenu, .usermenudiv").mouseenter(function() { $(".usermenudiv").show(); $(".usermenu").addClass("usermenuwhite"); }); $(".usermenu, .usermenudiv").mouseleave(function() { $(".usermenudiv").hide(); $(".usermenu").removeClass("usermenuwhite"); });</script>'),o(function(){e.cancel()},3e3)):e.userMessage=a.usermessage,console.log(r.get("loginStatus")),console.log(sessionStorage.getItem("loginuser"))}),t.error(function(a,n,s,t){e.userMessage="Something went wrong please try again later"})},e.proceedToPay=function(){token=i.encode(e.email+":"+e.password);var n={headers:{Authorization:"Basic eTEzdWMwMzJAbG5taWl0LmFjLmluOjExMTExMQ==","Content-Type":"application/x-www-form-urlencoded"}};data="appId=2&offerCode=:xuserPromoCodex:&buyer_name=:xusernamex:&amount=:xtotalAmountx:&requestId=:xbookingIDx:&purpose=Photography Services&phone=:xusermobilex:&send_email=true",data=data.replace(":xuserPromoCodex:",e.Promocode),data=data.replace(":xusernamex:",e.username),data=data.replace(":xtotalAmountx:",e.totalAmount),data=data.replace(":xbookingIDx:",e.bookingID),data=data.replace(":xusermobilex:",e.usermobile),data="appId=1&offerCode=NULL&buyer_name=Ankur&amount=5000&requestId=16031311304700047&purpose=purpose&phone=9910188803&send_email=true";var s=a.post("http://dhiya.16mb.com/eg-api/customer/payment",data,n);s.success(function(e,a,n,s){console.log(e.url)}),s.error(function(a,n,s,t){e.userMessage="Something went wrong please try again later"})}}if(console.log("Entering Found LogIn"),console.log(r.get("loginuser")),"true"==r.get("loginStatus")){console.log("Found LogIn");var u=r.get("loginuser");setTimeout(function(){$(".nav-wrapper").html('<div id="nav-icon"> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> </div> <a href="#/" class="brand-logo center"><img src="./media/images/logo.png" style="width: 90px; margin: 5px;"></a> <ul class="right usermenuul"> <li><a class="usermenu">'+u+' &nbsp; &nbsp; <i class="fa fa-chevron-circle-down"></i> </a> <ul> <div class="usermenudiv"> <div class="usermenupic"><span>'+u+'</span> <img src="https://image.freepik.com/free-icon/male-user-shadow_318-34042.png"> </div> <div class="usermenuopt"><a href="#/mybooking">My Booking</a></div> <div class="usermenuopt"><a href="#/profile">Profile</a></div> <div class="usermenuopt"><a onclick="logOut()" href="#/">LogOut</a></div> </div> </ul> </li> </ul> <script> $("#nav-icon").click(function(){ $(this).toggleClass("open"); $(".leftSubMenu").toggleClass("leftsubmenupos"); $(".leftoverlay").toggleClass("leftmenubackdrop"); $("nav").toggleClass("navbarline"); }); $(".usermenu, .usermenudiv").mouseenter(function() { $(".usermenudiv").show(); $(".usermenu").addClass("usermenuwhite"); }); $(".usermenu, .usermenudiv").mouseleave(function() { $(".usermenudiv").hide(); $(".usermenu").removeClass("usermenuwhite"); });</script>')},0)}Eventlist={events:[]},a({url:"http://dhiya.16mb.com/eg-api/cities",method:"get",headers:{}}).success(function(a,n,s,t){e.cities=a.cities}).error(function(e,a,n,s){}),e.homeSubmit=function(a){console.log(e.eventCity),n.path("/categories")},e.category,e.categorySelected=function(a){e.category=a,console.log(e.category),n.path("/event")},e.types=[{name:"Cinematographer"},{name:"Photographer"},{name:"Both"}],e.noOf=[1,2,3,4,5],e.eventTIME=[1,2,3,4,5,6,7,8,9,10,11,12],e.eventAMPM=["AM","PM"],e.eventHOUR=[1,2,3,4,5,6,7,8],e.LoginEle=["SignUp","LogIn"],e.eventName,e.eventCity,e.eventSelectedType,e.eventnoOf,e.eventTime,e.eventTimeAMPM,e.eventHours,e.eventAddress,e.bookingID,e.totalAmount,e.appId=2,eventCountx=0,e.userFname,e.usermobile,e.useremail,e.userpassword,e.username,e.userpassword,e.userPromoCode,e.signupBTN=function(e){s.show({controller:l,templateUrl:"js/app/dia1.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0})},e.loginBTN=function(e){s.show({controller:l,templateUrl:"js/app/dia2.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0})},signupBTNx=function(){e.signupBTN()},loginBTNx=function(){e.loginBTN()},e.accountVerifyAPI=function(){},e.accountVerify=function(){a({url:"http://dhiya.16mb.com/eg-api/cities",method:"get",headers:{}}).success(function(a,n,s,t){e.accountVerifyStatus=a}).error(function(e,a,n,s){})},logOut=function(){$(".nav-wrapper").html('<div id="nav-icon"> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> </div> <a href="#/" class="brand-logo center"><img src="./media/images/logo.png" style="width: 90px; margin: 5px;"></a> <ul class="right"> <li><a href="#/">Home</a></li> <li><a onclick="signupBTNx()" flex="100" flex-gt-md="auto">'+e.LoginEle[0]+'</a></li> <li><a onclick="loginBTNx()" flex="100" flex-gt-md="auto">'+e.LoginEle[1]+'</a></li> </ul> <script> $("#nav-icon").click(function(){ $(this).toggleClass("open"); $(".leftSubMenu").toggleClass("leftsubmenupos"); $(".leftoverlay").toggleClass("leftmenubackdrop"); $("nav").toggleClass("navbarline"); }); </script>'),r.put("loginStatus","false","")},e.eventAdd=function(){eventData={data:{eventType:e.eventName,city:e.eventCity,"cine/photo":e.eventSelectedType,noOfphotographers:e.eventnoOf,"time ":e.eventTime+" "+e.eventTimeAMPM,duration:e.eventHours,address:e.eventAddress,requirements:e.event}},Eventlist.events.push(eventData),console.log(Eventlist.events),console.log(sessionStorage.getItem("day")),console.log(sessionStorage.getItem("month")),console.log(sessionStorage.getItem("year"))},e.eventTest=function(){console.log(sessionStorage.getItem("day")),console.log(sessionStorage.getItem("month")),console.log(sessionStorage.getItem("year"))},e.eventsVerified=function(e){s.show({controller:l,templateUrl:"js/app/verifydia1.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0})}}]);